<section id="contact" class="terminal-section">
    <div class="container">
        <div class="terminal-window">
            <div class="terminal-header">
                <div class="buttons">
                    <span class="close"></span>
                    <span class="minimize"></span>
                    <span class="maximize"></span>
                </div>
                <div class="title">user@portfolio:~ (contacto)</div>
            </div>

            <div class="terminal-body">
                <div class="line">
                    <span class="prompt">user@dev:~$</span>
                    <span class="cmd">iniciar_protocolo_contacto.exe</span>
                </div>
                <div class="line output">
                    > Cargando interfaz de mensajería... <br />
                    > Conexión segura establecida. <br />
                    > Por favor, ingrese sus datos abajo:
                </div>

                <form
                    class="terminal-form"
                    id="contact-form"
                    action="https://formspree.io/f/xyzvekog"
                    method="POST"
                >
                    <div class="input-group">
                        <label for="name" class="prompt">TU NOMBRE > </label>
                        <input
                            type="text"
                            id="name"
                            name="name"
                            placeholder="Tu nombre"
                            autocomplete="off"
                            required
                        />
                    </div>

                    <div class="input-group">
                        <label for="email" class="prompt">TU CORREO > </label>
                        <input
                            type="email"
                            id="email"
                            name="email"
                            placeholder="tu_correo@gmail.com"
                            autocomplete="off"
                            required
                        />
                    </div>

                    <div class="input-group">
                        <label for="message" class="prompt">MENSAJE > </label>
                        <textarea
                            id="message"
                            name="message"
                            rows="3"
                            placeholder="Tu mensaje..."
                            required></textarea>
                    </div>

                    <button type="submit" class="submit-cmd"
                        >[ ENVIAR_DATOS ]</button
                    >

                    <div id="form-status" class="form-status"></div>
                </form>
            </div>
        </div>
    </div>
</section>

<style>
    .terminal-section {
        padding: 100px 0;
        display: flex;
        justify-content: center;
    }

    .terminal-window {
        width: 100%;
        max-width: 700px;
        background: rgba(10, 10, 10, 0.95);
        border: 1px solid #333;
        border-radius: 8px;
        box-shadow: 0 0 40px rgba(0, 243, 255, 0.1);
        overflow: hidden;
        font-family: "Courier New", monospace;
    }

    .terminal-header {
        background: #1a1a1a;
        padding: 10px 15px;
        display: flex;
        align-items: center;
        border-bottom: 1px solid #333;
    }

    .buttons {
        display: flex;
        gap: 8px;
        margin-right: 20px;
    }
    .buttons span {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        display: inline-block;
    }
    .close {
        background: #ff5f56;
    }
    .minimize {
        background: #ffbd2e;
    }
    .maximize {
        background: #27c93f;
    }

    .title {
        color: #888;
        font-size: 0.9rem;
    }

    .terminal-body {
        padding: 20px;
        color: var(--text-main);
    }

    .line {
        margin-bottom: 10px;
    }
    .prompt {
        color: var(--accent);
        margin-right: 10px;
        font-weight: bold;
    }
    .cmd {
        color: #fff;
    }
    .output {
        color: #aaa;
        margin-bottom: 20px;
        font-size: 0.9rem;
    }

    /* Formulario estilo CLI */
    .input-group {
        display: flex;
        align-items: baseline;
        margin-bottom: 15px;
        flex-wrap: wrap;
    }

    .input-group label {
        min-width: 150px;
    }

    input,
    textarea {
        background: transparent;
        border: none;
        color: #fff;
        font-family: "Courier New", monospace;
        font-size: 1rem;
        flex: 1;
        outline: none;
        border-bottom: 1px dashed #444;
        padding: 5px;
    }

    input:focus,
    textarea:focus {
        border-bottom: 1px dashed var(--accent);
    }

    .submit-cmd {
        background: transparent;
        border: 1px solid var(--accent);
        color: var(--accent);
        padding: 10px 20px;
        margin-top: 20px;
        cursor: pointer;
        font-family: inherit;
        font-weight: bold;
        transition: 0.3s;
        width: 100%;
    }

    .submit-cmd:hover:not(:disabled) {
        background: var(--accent);
        color: #000;
        box-shadow: 0 0 15px var(--accent);
    }

    .submit-cmd:disabled {
        opacity: 0.5;
        cursor: not-allowed;
    }

    .form-status {
        margin-top: 20px;
        padding: 10px;
        border-radius: 4px;
        font-size: 0.9rem;
        display: none;
    }

    .form-status.success {
        display: block;
        background: rgba(39, 201, 63, 0.1);
        border: 1px solid #27c93f;
        color: #27c93f;
    }

    .form-status.error {
        display: block;
        background: rgba(255, 95, 86, 0.1);
        border: 1px solid #ff5f56;
        color: #ff5f56;
    }
</style>

<script>
    const form = document.getElementById("contact-form") as HTMLFormElement;
    const statusDiv = document.getElementById("form-status") as HTMLDivElement;
    const submitBtn = document.querySelector(
        ".submit-cmd",
    ) as HTMLButtonElement;

    if (form && statusDiv && submitBtn) {
        form.addEventListener("submit", async (e) => {
            e.preventDefault();

            // Deshabilitar botón mientras se envía
            submitBtn.disabled = true;
            submitBtn.textContent = "[ ENVIANDO... ]";
            statusDiv.className = "form-status";

            try {
                const formData = new FormData(form);
                const response = await fetch(form.action, {
                    method: "POST",
                    body: formData,
                    headers: {
                        Accept: "application/json",
                    },
                });

                if (response.ok) {
                    statusDiv.className = "form-status success";
                    statusDiv.textContent =
                        "> ✓ Mensaje enviado exitosamente. Te responderé pronto!";
                    form.reset();

                    // Ocultar mensaje después de 5 segundos
                    setTimeout(() => {
                        statusDiv.className = "form-status";
                    }, 5000);
                } else {
                    throw new Error("Error al enviar el formulario");
                }
            } catch (error) {
                statusDiv.className = "form-status error";
                statusDiv.textContent =
                    "> ✗ Error al enviar el mensaje. Por favor, intenta de nuevo o escríbeme directamente a campos25ariel@gmail.com";

                // Ocultar mensaje de error después de 5 segundos
                setTimeout(() => {
                    statusDiv.className = "form-status";
                }, 5000);
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = "[ ENVIAR_DATOS ]";
            }
        });
    }

    // Efecto de focus en los inputs
    const inputs = document.querySelectorAll("input, textarea");
    inputs.forEach((input) => {
        input.addEventListener("focus", () => {
            input.parentElement
                ?.querySelector(".prompt")
                ?.classList.add("active");
        });
        input.addEventListener("blur", () => {
            input.parentElement
                ?.querySelector(".prompt")
                ?.classList.remove("active");
        });
    });
</script>
